//Generated by TurboLink CodeGenerator, do not edit!
#include "SLobby/LobbyService.h"
#include "SLobby/LobbyClient.h"
#include "LobbyService_Private.h"
#include "LobbyMarshaling.h"
#include "SGoogleProtobuf/TimestampMarshaling.h"
#include "TurboLinkGrpcManager_Private.h"
#include "TurboLinkGrpcUtilities.h"

ULobbyService::ULobbyService()
	: d(new ULobbyService::Private())
{
}

ULobbyService::~ULobbyService()
{
	delete d;
}

void ULobbyService::Connect()
{
	FString serviceEndPoint = UTurboLinkGrpcUtilities::GetTurboLinkGrpcConfig()->GetServiceEndPoint(TEXT("LobbyService"));
	UE_LOG(LogTurboLink, Warning, TEXT("Connect to LobbyService: '%s'"), *serviceEndPoint);

	if (d->Channel == nullptr) {
		d->Channel = TurboLinkManager->d->CreateServiceChannel((const char*)StringCast<UTF8CHAR>(*serviceEndPoint).Get(), this);
	}
	if (d->Stub == nullptr) {
		d->Stub = lobby::LobbyService::NewStub(d->Channel->RpcChannel);
	}

	grpc_connectivity_state currentChannelState = d->Channel->RpcChannel->GetState(true);
	if (OnServiceStateChanged.IsBound())
	{
		OnServiceStateChanged.Broadcast(UTurboLinkGrpcManager::Private::GrpcStateToServiceState(currentChannelState));
	}
}

EGrpcServiceState ULobbyService::GetServiceState() const
{
	if (d->Channel == nullptr) return EGrpcServiceState::NotCreate;

	auto rpcChannelState = d->Channel->RpcChannel->GetState(false);
	return UTurboLinkGrpcManager::Private::GrpcStateToServiceState(rpcChannelState);
}

ULobbyServiceClient* ULobbyService::MakeClient()
{
	auto client = UGrpcService::MakeClient<ULobbyServiceClient>();
	return client;
}

void ULobbyService::Shutdown()
{
	Super::Shutdown();
	d->Stub = nullptr;
	if (d->Channel != nullptr) {
		TurboLinkManager->d->RemoveServiceChannel(d->Channel, this);
		d->Channel = nullptr;
	}
}

void ULobbyService::CallCreateRoom(const FGrpcLobbyCreateRoomRequest& Request, FCreateRoomResponseLambda ResponseLambda, FGrpcMetaData MetaData, float DeadLineSeconds)
{
	if (InnerClient == nullptr)
	{
		InnerClient = MakeClient();
	}
	ULobbyServiceCreateRoomLambdaWrapper* lambdaWrapper = NewObject<ULobbyServiceCreateRoomLambdaWrapper>();
	lambdaWrapper->InnerClient = InnerClient;
	lambdaWrapper->ResponseLambda = ResponseLambda;
	lambdaWrapper->Handle = InnerClient->InitCreateRoom();
	InnerClient->OnCreateRoomResponse.AddUniqueDynamic(lambdaWrapper, &ULobbyServiceCreateRoomLambdaWrapper::OnResponse);
	InnerClient->CreateRoom(lambdaWrapper->Handle, Request, MetaData, DeadLineSeconds);
}

void ULobbyService::CallJoinRoom(const FGrpcLobbyJoinRoomRequest& Request, FJoinRoomResponseLambda ResponseLambda, FGrpcMetaData MetaData, float DeadLineSeconds)
{
	if (InnerClient == nullptr)
	{
		InnerClient = MakeClient();
	}
	ULobbyServiceJoinRoomLambdaWrapper* lambdaWrapper = NewObject<ULobbyServiceJoinRoomLambdaWrapper>();
	lambdaWrapper->InnerClient = InnerClient;
	lambdaWrapper->ResponseLambda = ResponseLambda;
	lambdaWrapper->Handle = InnerClient->InitJoinRoom();
	InnerClient->OnJoinRoomResponse.AddUniqueDynamic(lambdaWrapper, &ULobbyServiceJoinRoomLambdaWrapper::OnResponse);
	InnerClient->JoinRoom(lambdaWrapper->Handle, Request, MetaData, DeadLineSeconds);
}

void ULobbyService::CallGetRoomList(const FGrpcLobbyGetRoomListRequest& Request, FGetRoomListResponseLambda ResponseLambda, FGrpcMetaData MetaData, float DeadLineSeconds)
{
	if (InnerClient == nullptr)
	{
		InnerClient = MakeClient();
	}
	ULobbyServiceGetRoomListLambdaWrapper* lambdaWrapper = NewObject<ULobbyServiceGetRoomListLambdaWrapper>();
	lambdaWrapper->InnerClient = InnerClient;
	lambdaWrapper->ResponseLambda = ResponseLambda;
	lambdaWrapper->Handle = InnerClient->InitGetRoomList();
	InnerClient->OnGetRoomListResponse.AddUniqueDynamic(lambdaWrapper, &ULobbyServiceGetRoomListLambdaWrapper::OnResponse);
	InnerClient->GetRoomList(lambdaWrapper->Handle, Request, MetaData, DeadLineSeconds);
}

void ULobbyService::CallUpdateRoomState(const FGrpcLobbyUpdateRoomStateRequest& Request, FUpdateRoomStateResponseLambda ResponseLambda, FGrpcMetaData MetaData, float DeadLineSeconds)
{
	if (InnerClient == nullptr)
	{
		InnerClient = MakeClient();
	}
	ULobbyServiceUpdateRoomStateLambdaWrapper* lambdaWrapper = NewObject<ULobbyServiceUpdateRoomStateLambdaWrapper>();
	lambdaWrapper->InnerClient = InnerClient;
	lambdaWrapper->ResponseLambda = ResponseLambda;
	lambdaWrapper->Handle = InnerClient->InitUpdateRoomState();
	InnerClient->OnUpdateRoomStateResponse.AddUniqueDynamic(lambdaWrapper, &ULobbyServiceUpdateRoomStateLambdaWrapper::OnResponse);
	InnerClient->UpdateRoomState(lambdaWrapper->Handle, Request, MetaData, DeadLineSeconds);
}

void ULobbyService::CallUpdateRoomConfig(const FGrpcLobbyUpdateRoomConfigRequest& Request, FUpdateRoomConfigResponseLambda ResponseLambda, FGrpcMetaData MetaData, float DeadLineSeconds)
{
	if (InnerClient == nullptr)
	{
		InnerClient = MakeClient();
	}
	ULobbyServiceUpdateRoomConfigLambdaWrapper* lambdaWrapper = NewObject<ULobbyServiceUpdateRoomConfigLambdaWrapper>();
	lambdaWrapper->InnerClient = InnerClient;
	lambdaWrapper->ResponseLambda = ResponseLambda;
	lambdaWrapper->Handle = InnerClient->InitUpdateRoomConfig();
	InnerClient->OnUpdateRoomConfigResponse.AddUniqueDynamic(lambdaWrapper, &ULobbyServiceUpdateRoomConfigLambdaWrapper::OnResponse);
	InnerClient->UpdateRoomConfig(lambdaWrapper->Handle, Request, MetaData, DeadLineSeconds);
}

void ULobbyService::CallUpdatePlayerState(const FGrpcLobbyUpdatePlayerStateRequest& Request, FUpdatePlayerStateResponseLambda ResponseLambda, FGrpcMetaData MetaData, float DeadLineSeconds)
{
	if (InnerClient == nullptr)
	{
		InnerClient = MakeClient();
	}
	ULobbyServiceUpdatePlayerStateLambdaWrapper* lambdaWrapper = NewObject<ULobbyServiceUpdatePlayerStateLambdaWrapper>();
	lambdaWrapper->InnerClient = InnerClient;
	lambdaWrapper->ResponseLambda = ResponseLambda;
	lambdaWrapper->Handle = InnerClient->InitUpdatePlayerState();
	InnerClient->OnUpdatePlayerStateResponse.AddUniqueDynamic(lambdaWrapper, &ULobbyServiceUpdatePlayerStateLambdaWrapper::OnResponse);
	InnerClient->UpdatePlayerState(lambdaWrapper->Handle, Request, MetaData, DeadLineSeconds);
}

void ULobbyService::CallChangeRoomPassword(const FGrpcLobbyChangeRoomPasswordRequest& Request, FChangeRoomPasswordResponseLambda ResponseLambda, FGrpcMetaData MetaData, float DeadLineSeconds)
{
	if (InnerClient == nullptr)
	{
		InnerClient = MakeClient();
	}
	ULobbyServiceChangeRoomPasswordLambdaWrapper* lambdaWrapper = NewObject<ULobbyServiceChangeRoomPasswordLambdaWrapper>();
	lambdaWrapper->InnerClient = InnerClient;
	lambdaWrapper->ResponseLambda = ResponseLambda;
	lambdaWrapper->Handle = InnerClient->InitChangeRoomPassword();
	InnerClient->OnChangeRoomPasswordResponse.AddUniqueDynamic(lambdaWrapper, &ULobbyServiceChangeRoomPasswordLambdaWrapper::OnResponse);
	InnerClient->ChangeRoomPassword(lambdaWrapper->Handle, Request, MetaData, DeadLineSeconds);
}

void ULobbyService::CallChangeRoomOwner(const FGrpcLobbyChangeRoomOwnerRequest& Request, FChangeRoomOwnerResponseLambda ResponseLambda, FGrpcMetaData MetaData, float DeadLineSeconds)
{
	if (InnerClient == nullptr)
	{
		InnerClient = MakeClient();
	}
	ULobbyServiceChangeRoomOwnerLambdaWrapper* lambdaWrapper = NewObject<ULobbyServiceChangeRoomOwnerLambdaWrapper>();
	lambdaWrapper->InnerClient = InnerClient;
	lambdaWrapper->ResponseLambda = ResponseLambda;
	lambdaWrapper->Handle = InnerClient->InitChangeRoomOwner();
	InnerClient->OnChangeRoomOwnerResponse.AddUniqueDynamic(lambdaWrapper, &ULobbyServiceChangeRoomOwnerLambdaWrapper::OnResponse);
	InnerClient->ChangeRoomOwner(lambdaWrapper->Handle, Request, MetaData, DeadLineSeconds);
}

void ULobbyService::CallDeleteRoom(const FGrpcLobbyDeleteRoomRequest& Request, FDeleteRoomResponseLambda ResponseLambda, FGrpcMetaData MetaData, float DeadLineSeconds)
{
	if (InnerClient == nullptr)
	{
		InnerClient = MakeClient();
	}
	ULobbyServiceDeleteRoomLambdaWrapper* lambdaWrapper = NewObject<ULobbyServiceDeleteRoomLambdaWrapper>();
	lambdaWrapper->InnerClient = InnerClient;
	lambdaWrapper->ResponseLambda = ResponseLambda;
	lambdaWrapper->Handle = InnerClient->InitDeleteRoom();
	InnerClient->OnDeleteRoomResponse.AddUniqueDynamic(lambdaWrapper, &ULobbyServiceDeleteRoomLambdaWrapper::OnResponse);
	InnerClient->DeleteRoom(lambdaWrapper->Handle, Request, MetaData, DeadLineSeconds);
}

void ULobbyService::CallUpdateRoomConfigStream(const FGrpcLobbyListenRoomConfigUpdatesRequest& Request, FUpdateRoomConfigStreamResponseLambda ResponseLambda, FUpdateRoomConfigStreamFinishLambda FinishLambda, FGrpcMetaData MetaData, float DeadLineSeconds)
{
	if (InnerClient == nullptr)
	{
		InnerClient = MakeClient();
	}
	ULobbyServiceUpdateRoomConfigStreamLambdaWrapper* lambdaWrapper = NewObject<ULobbyServiceUpdateRoomConfigStreamLambdaWrapper>();
	lambdaWrapper->InnerClient = InnerClient;
	lambdaWrapper->ResponseLambda = ResponseLambda;
	lambdaWrapper->FinishLambda = FinishLambda;
	lambdaWrapper->Handle = InnerClient->InitUpdateRoomConfigStream();
	InnerClient->OnUpdateRoomConfigStreamResponse.AddUniqueDynamic(lambdaWrapper, &ULobbyServiceUpdateRoomConfigStreamLambdaWrapper::OnResponse);
	InnerClient->OnContextStateChange.AddUniqueDynamic(lambdaWrapper, &ULobbyServiceUpdateRoomConfigStreamLambdaWrapper::OnContextStateChanged);
	InnerClient->UpdateRoomConfigStream(lambdaWrapper->Handle, Request, MetaData, DeadLineSeconds);
}

void ULobbyService::CallUpdatePlayerListStream(const FGrpcLobbyListenPlayerListUpdatesRequest& Request, FUpdatePlayerListStreamResponseLambda ResponseLambda, FUpdatePlayerListStreamFinishLambda FinishLambda, FGrpcMetaData MetaData, float DeadLineSeconds)
{
	if (InnerClient == nullptr)
	{
		InnerClient = MakeClient();
	}
	ULobbyServiceUpdatePlayerListStreamLambdaWrapper* lambdaWrapper = NewObject<ULobbyServiceUpdatePlayerListStreamLambdaWrapper>();
	lambdaWrapper->InnerClient = InnerClient;
	lambdaWrapper->ResponseLambda = ResponseLambda;
	lambdaWrapper->FinishLambda = FinishLambda;
	lambdaWrapper->Handle = InnerClient->InitUpdatePlayerListStream();
	InnerClient->OnUpdatePlayerListStreamResponse.AddUniqueDynamic(lambdaWrapper, &ULobbyServiceUpdatePlayerListStreamLambdaWrapper::OnResponse);
	InnerClient->OnContextStateChange.AddUniqueDynamic(lambdaWrapper, &ULobbyServiceUpdatePlayerListStreamLambdaWrapper::OnContextStateChanged);
	InnerClient->UpdatePlayerListStream(lambdaWrapper->Handle, Request, MetaData, DeadLineSeconds);
}
